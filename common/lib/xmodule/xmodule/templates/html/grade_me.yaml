---
metadata:
    display_name: (Grade Me!)  Button
data: |
      <p>By clicking the button below, you certify that you have completed the course in its entirety.</p>
      
      <!-- <form action=/request_certificate method=POST>
        <input type=hidden name=student_id value=103 />
        <input type=hidden name=course_id value="OpenEdX/200/Stanford_Sandbox" />
        <input type=submit name="hoo" />
      </form> -->
      
      <input type=button value="Yes, I Agree." id="User_Verify_Button" style="margin-bottom: 20px;" />
      
      <script type="text/javascript">
        var success_message = "Your grading and certification request has been received, <br />if you have passed, your certificate should be available in the next 20 minutes.";
        document.getElementById('User_Verify_Button').addEventListener("click",
        function(event) {
          (function(event) {
            var linkcontents = $('a.user-link').contents();
            var username = $.trim(linkcontents[linkcontents.length-1].data);
            $.ajax({
              type:     'POST',
              url:      '/request_certificate',
              data:     {'username': username, 'course_id': $$course_id},
              success:  function(data) {
                $('#User_Verify_Button').after('<p style="font-weight: bold; color: #008200;">' + success_message + '</p>');
              }
            });
          }).call(document.getElementById('click_me'), event);
        });
      </script>